from flask import Flask, render_template, request, redirect, url_for
import random
import csv

ck_test = Flask(__name__)

# База вопросов и ответов
questions_linux = [
    {
        "question": "Создателем Linux является:",
        "options": ["Билл Гейтс", "Ричард Столлман", "Линус Торвальдс", "Стив Джобс"],
        "correct_answers": ["Ричард Столлман", "Линус Торвальдс"]
    },
    {
        "question": "Linux – это?",
        "options": ["Операционная система", "Семейство операционных систем", "Набор программ с открытым исходным кодом", "Комбинация ядра Linux и инструментов GNU"],
        "correct_answers": ["Семейство операционных систем", "Комбинация ядра Linux и инструментов GNU"]
    },
    {
        "question": "Какое ядро Linux-подобные ОС в современное время используют?",
        "options": ["монолитное ядро", "микроядро", "гибридное ядро", "мультиядро"],
        "correct_answers": ["монолитное ядро"]
    },
    {
        "question": "Каким образом вывести неинтерактивную справку о параметрах команды?",
        "options": ["<наименование_команды> -help", "help <наименование_команды>", "<наименование_команды> --help", "<наименование_команды> -h"],
        "correct_answers": ["<наименование_команды> --help", "<наименование_команды> -h"]
    },
    {
        "question": "Подробный мануал по команде можно получить:",
        "options": ["manual <наименование_команды>", "man <наименование_команды>", "help <наименование_команды>", "<наименование_команды> man"],
        "correct_answers": ["man <наименование_команды>"]
    },
     {
        "question": "Имеет ли значение регистр вводимых данных в терминал при наборе команд и параметров?",
        "options": ["да", "нет", "в зависимости от ситуации", "имел до версии ядра 3.10.0-0160.21.el6"],
        "correct_answers": ["да"]
    },
    {
        "question": "Как вывести путь до исполняемого файла команды?",
        "options": ["locate <имя_команды>", "where <имя_команды>", "which <имя_команды>", "pwd <имя_команды>"],
        "correct_answers": ["which <имя_команды>"]
    },
    {
        "question": "Как выключить машину, работающую под управлением Linux?",
        "options": ["poweroff", "shutdown -P", "halt -p", "reboot -p"],
        "correct_answers": ["poweroff", "shutdown -P", "halt -p", "reboot -p"]
    },
    {
        "question": "Как перезагрузить машину, работающую под управлением Linux?",
        "options": ["poweroff --reboot", "shutdown -r", "halt --reboot", "reboot"],
        "correct_answers": ["poweroff --reboot", "shutdown -r", "halt --reboot", "reboot"]
    },
    {
        "question": "Что такое inode в Linux?",
        "options": ["Информация об объекте файловой системы", "Метаданные", "Уникальный идентификатор, присвоенный каждому файлу и директории в Linux", "Специальный файл, который содержит информацию о файловой системе."],
        "correct_answers": ["Уникальный идентификатор, присвоенный каждому файлу и директории в Linux"]
    },
    {
        "question": "Как можно узнать inode файла или директории в Linux?",
        "options": ["ls -i", "inode <имя_файла>", "cat <имя_файла>", "stat <имя_файла>"],
        "correct_answers": ["ls -i", "stat <имя_файла>"]
    },
    {
        "question": "Какие атрибуты содержит inode в Linux?",
        "options": ["Имя файла, размер, права доступа", "Имя файла, размер, дата создания", "Размер, права доступа, дата создания", "Владелец, группа, права доступа, расположение на жестком диске"],
        "correct_answers": ["Размер, права доступа, дата создания", "Владелец, группа, права доступа, расположение на жестком диске"]
    },
     {
        "question": "Что произойдет с inode файла при переименовании?",
        "options": ["inode останется неизменным", "inode будет удален и создан новый", "inode будет перезаписан новыми данными", "inode будет перемещен в другую директорию"],
        "correct_answers": ["inode останется неизменным"]
    },
    {
        "question": "Что произойдет с inode файла при его удалении?",
        "options": ["inode будет удален и освобожден для использования другими файлами", "inode останется неизменным, но файл будет помечен как удаленный", "inode будет перемещен в корзину", "inode будет скопирован и сохранен в резервной копии"],
        "correct_answers": ["inode будет удален и освобожден для использования другими файлами"]
    },
    {
        "question": "Какая команда используется для перемещения файла в Linux?",
        "options": ["cp", "move", "mv", "copy"],
        "correct_answers": ["mv"]
    },
    {
        "question": "Какая команда используется для копирования файла в Linux?",
        "options": ["cp", "move", "mv", "copy"],
        "correct_answers": ["cp"]
    },
     {
        "question": "Какая команда используется для удаления файла в Linux?",
        "options": ["mkdir", "remove", "rm", "del"],
        "correct_answers": ["rm"]
    },
    {
        "question": "Какая команда используется для создания каталога в Linux?",
        "options": ["mkdir", "dir", "makedir", "mvdir"],
        "correct_answers": ["mkdir"]
    },
    {
        "question": "Какая команда используется для удаления пустого каталога в Linux?",
        "options": ["rmdir", "rm", "deldir", "del"],
        "correct_answers": ["rmdir"]
    },
    {
        "question": "Какая команда используется для изменения прав доступа к файлу или директории в Linux?",
        "options": ["chown", "chmodx", "chmod", "chaccess"],
        "correct_answers": ["chmod"]
    },
    {
        "question": "Какая команда используется для архивирования файлов/директорий в Linux?",
        "options": ["7zip", "gzip", "tar", "compress"],
        "correct_answers": ["tar"]
    },
    {
        "question": "Какая команда используется для сжатия файлов в Linux?",
        "options": ["7zip", "gzip", "tar", "compress"],
        "correct_answers": ["gzip", "compress"]
    },
    {
        "question": "Какие команды можно использовать для разархивирования файлов в Linux?",
        "options": ["gunzip", "ungzip", "untar", "tar"],
        "correct_answers": ["ungzip", "tar"]
    },
    {
        "question": "Какая команда используется для поиска файлов и директорий по их имени в Linux?",
        "options": ["find", "locate", "grep", "search"],
        "correct_answers": ["find", "locate"]
    },
    {
        "question": "Какая команда используется для поиска строки в содержимом файла в Linux?",
        "options": ["find", "locate", "grep", "search"],
        "correct_answers": ["grep"]
    },
    {
        "question": "Как создать жесткую ссылку на файл в Linux?",
        "options": ["ln -s <исходный_файл> <ссылка>", "ln <ссылка> <исходный_файл>", "ln <исходный_файл> <ссылка>", "ln -h <исходный_файл> <ссылка>"],
        "correct_answers": ["ln <исходный_файл> <ссылка>"]
    },
    {
        "question": "Как создать символьную ссылку на файл в Linux?",
        "options": ["ln -s <ссылка> <исходный_файл>", "ln -s <исходный_файл> <ссылка>", "ln <исходный_файл> <ссылка>", "ln -h <исходный_файл> <ссылка>"],
        "correct_answers": ["ln -s <исходный_файл> <ссылка>"]
    },
    {
        "question": "Как узнать, на какой файл указывает символьная ссылка, используя команду ls?",
        "options": ["ls -l <символьная_ссылка>", "ls -s <символьная_ссылка>", "ls -h <символьная_ссылка>", "ls -a <символьная_ссылка>"],
        "correct_answers": ["ls -l <символьная_ссылка>"]
    },
    {
        "question": "Что произойдет, если удалить исходный файл, на который указывает жесткая ссылка?",
        "options": ["Жесткая ссылка будет автоматически удалена.", "Жесткая ссылка останется, но будет указывать на несуществующий файл.", "Жесткая ссылка будет преобразована в символьную ссылку.", "Жесткая ссылка будет продолжать указывать на исходный файл."],
        "correct_answers": ["Жесткая ссылка будет продолжать указывать на исходный файл."]
    },
    {
        "question": "Для возможности перехода в каталог конкретному пользователю необходимы права:",
        "options": ["На запись в каталог", "На чтение каталога", "На «выполнение» каталога", "На чтение и «выполнение» каталога"],
        "correct_answers": ["На «выполнение» каталога"]
    },
    {
        'question': 'Для возможности чтения содержимого каталога конкретному пользователю необходимы права:',
        'options': ['На чтение каталога', 'На запись в каталог', 'На «выполнение» каталога', 'На чтение и «выполнение» каталога'],
        'correct_answers': ['На чтение каталога', 'На «выполнение» каталога']
    },
    {
        'question': 'Для возможности создания файлов в каталоге конкретному пользователю необходимы права:',
        'options': ['На чтение каталога', 'На запись в каталог', 'На «выполнение» каталога', 'На чтение и «выполнение» каталога'],
        'correct_answers': ['На запись в каталог']
    },
	{
        'question': 'В рабочей директории есть файл file.txt. Права доступа к нему -rwxr¬¬¬-xr--. Необходимо запретить читать файл всем остальным пользователям кроме владельца и группы-владельца, не изменяя остальных разрешений:',
        'options': ['chmod -r file.txt', 'chmod 750 file.txt', 'chmod 057 file.txt', 'chmod o-r file.txt', 'chmod o:-r file.txt'],
        'correct_answers': ['chmod o-r file.txt', 'chmod 750 file.txt']
    },
    {
        'question': 'В рабочей директории есть файл file.txt. Права доступа к нему отсутствуют у всех. Необходимо добавить права на запись, чтение и выполнение для владельца, на чтение и выполнение для группы и на чтение для всех остальных:',
        'options': ['chmod 457 file.txt', 'chmod 754 file.txt', 'chmod u+rwx g+rx o+r file.txt', 'chmod 777 file.txt'],
        'correct_answers': ['chmod 754 file.txt', 'chmod u+rwx g+rx o+r file.txt']
    },
    {
        'question': 'Необходимо создать файл garda.cfg в каталоге /opt/Garda c содержимым «secret». Вывод команды pwd: /opt/imperva. Выберите один или несколько вариантов:',
        'options': ['touch secret > /opt/Garda/garda.cfg', 'touch secret < /opt/Garda/garda.cfg', 'echo secret > ../Garda/garda.cfg', 'echo /opt/Garda/garda.cfg < secret', 'echo secret > /opt/Garda/garda.cfg'],
        'correct_answers': ['echo secret > ../Garda/garda.cfg', 'echo secret > /opt/Garda/garda.cfg']
    },
    {
        'question': 'Какой текстовый редактор для терминала доступен в любой версии linux с момента установки ОС:',
        'options': ['nano', 'vi (vim)', 'mcedit', 'ee'],
        'correct_answers': ['vi (vim)']
    },
    {
        'question': 'Выберите верные комбинации горячих клавиш при работе в nano:',
        'options': ['ctrl+o - выйти; ctrl+s – сохранить; ctrl+h – поиск; ctrl+x – заменить; ctrl+z – отменить', 'ctrl+Esc – выйти; ctrl+s – сохранить; alt+f – поиск; ctrl+h – заменить; alt+z – отменить', 'ctrl+e – выйти; ctrl+s – сохранить; ctrl+f – поиск; ctrl+h – заменить; ctrl+z - отменить', 'ctrl+x – выйти; ctrl+o – сохранить; ctrl+w – поиск; ctrl+\\ - заменить; alt+u – отменить'],
        'correct_answers': ['ctrl+x – выйти; ctrl+o – сохранить; ctrl+w – поиск; ctrl+\\ - заменить; alt+u – отменить']
    },
    {
        'question': 'Файл редактировался в редакторе vi (vim). Как выйти из редактора:',
        'options': ['ctrl+q – без сохранения; ctrl+w – с сохранением', ':q – без сохранения; :wq – с сохранением', ':wq – без сохранения; :q! ¬- с сохранением', ':q! – без сохранения; :wq – с сохранением'],
        'correct_answers': [':q! – без сохранения; :wq – с сохранением']
    },
    {
        'question': 'Какая команда используется для вывода содержимого текстового файла textfile в терминал в интерактивном режиме:',
        'options': ['ls textfile', 'cat textfile', 'less textfile', 'nano textfile'],
        'correct_answers': ['less textfile']
    },
    {
        'question': 'Какая команда используется для вывода содержимого текстового файла textfile в терминал:',
        'options': ['ls textfile', 'cat textfile', 'less textfile', 'nano textfile'],
        'correct_answers': ['cat textfile']
    },
    {
        'question': 'Как вывести 10 первых строк текстового файла textfile:',
        'options': ['top -n 10 textfile', 'tail -n 10 textfile', 'head -n 10 textfile', 'bottom -n 10 textfile'],
        'correct_answers': ['head -n 10 textfile']
    },
    {
        'question': 'Как вывести 10 последних строк текстового файла textfile:',
        'options': ['top -n 10 textfile', 'tail -n 10 textfile', 'head -n 10 textfile', 'bottom -n 10 textfile'],
        'correct_answers': ['tail -n 10 textfile']
    },
    {
        'question': 'Что такое журналируемая файловая система?',
        'options': ['ФС с возможностью логирования всех действий с ней в журнал', 'ФС с возможностью журналирования действий чтения объектов', 'ФС с возможностью логирования действий записи объектов', 'ФС с возможностью восстанавливать данные из журнала после удаления'],
        'correct_answers': ['ФС с возможностью логирования всех действий с ней в журнал']
    },
    {
        'question': 'Журналируемыми файловыми системами являются:',
        'options': ['ext2', 'ext4', 'NTFS', 'exFAT', 'FAT32'],
        'correct_answers': ['ext4', 'NTFS']
    },
    {
        'question': 'Что такое точка монтирования?',
        'options': ['Раздел файловой системы', 'Каталог файловой системы в Linux, куда подключается целая файловая система или блочное устройство', 'Раздел файловой системы в Linux, куда подключается целая файловая система или блочное устройство', 'Файловая система'],
        'correct_answers': ['Каталог файловой системы в Linux, куда подключается целая файловая система или блочное устройство']
    },
    {
        'question': 'Точкой монтирования корневого раздела в Linux является:',
        'options': ['C:', '/dev/root', '/', '/dev/sda'],
        'correct_answers': ['/']
    },
    {
        'question': 'Файл, содержащий информацию о монтируемых при загрузке ОС файловых системах, называется',
        'options': ['/etc/mount', '/dev/mount', '/etc/fstab', '/root/fstab'],
        'correct_answers': ['/etc/fstab']
    },
    {
        'question': 'Вывести информацию о всех доступных блочных устройствах в ОС можно командами:',
        'options': ['dmesg', 'lsblk', 'lspci', 'df -a', 'fdisk -l'],
        'correct_answers': ['lsblk', 'fdisk -l']
    },
    {
        'question': 'Вывести информацию о всех смонтированных файловых системах возможно командами:',
        'options': ['dmesg', 'lsblk', 'lspci', 'df -a', 'fdisk -l'],
        'correct_answers': ['df -a']
    },
    {
        'question': 'Вывести информацию о всех разделах блочного устройства возможно командами:',
        'options': ['dmesg', 'lsblk', 'lspci', 'df -a', 'fdisk -l'],
        'correct_answers': ['lsblk', 'fdisk -l', 'df -a']
    },
    {
        'question': 'Необходимо смонтировать устройство /dev/sr0 в каталог /media/cdrom. Запись об устройстве /dev/sr0 имеется в файле /etc/fstab:',
        'options': ['mount -a', 'mount /media/cdrom /dev/sr0 -o defaults', 'mount /dev/sr0 /media/cdrom -o defaults', 'sudo mount /dev/sr0 /media/cdrom -o defaults', 'mount --target /media/cdrom'],
        'correct_answers': ['mount -a', 'sudo mount /dev/sr0 /media/cdrom -o defaults']
    },
	{
        'question': 'Необходимо отмонтировать устройство /dev/usbflash0, смонтированное в каталог пользователя /home/gardauser/usbflash0. Устройство было смонтировано пользователем gardauser:',
        'options': ['unmount /dev/usbflash0 /home/gardauser/usbflash0', 'umount -a', 'unmount /dev/usbflash0', 'umount /dev/usbflash0', 'umount /home/gardauser/usbflash0'],
        'correct_answers': ['umount /home/gardauser/usbflash0', 'umount /dev/usbflash0']
	},
	{
        'question': 'Необходимо отмонтировать устройство /dev/usbflash0, смонтированное в каталог пользователя /media/usbflash0. Устройство было смонтировано пользователем root. Пользователь не добавлен в sudoers:',
        'options': ['unmount /dev/usbflash0 /media/usbflash0', 'umount -a', 'unmount /dev/usbflash0', 'sudo umount /dev/usbflash0', 'sudo umount /home/gardauser/usbflash0', 'Ни один из вариантов не является верным'],
        'correct_answers': ['Ни один из вариантов не является верным']
	},
	{
		'question': 'Для запуска приложений c правами root необходимо:',
		'options': ['быть суперпользователем', 'иметь права на запуск исполняемого файла, быть суперпользователем или быть в списке sudoers', 'иметь права на запуск исполняемого файла', 'быть в списке sudoers'],
		'correct_answers': ['иметь права на запуск исполняемого файла, быть суперпользователем или быть в списке sudoers']
	},
	{
		'question': 'Вы работает под непривелигированным пользователем guest. Чтобы сменить пользователя в терминале на user необходимо ввести:',
		'options': ['sudo user <пароль пользователя>', 'su user <пароль_пользователя>', 'su user, затем пароль пользователя', 'sudo su user'],
		'correct_answers': ['su user, затем пароль пользователя']
	},
	{
		'question': 'Чтобы добавить пользователя testuser в систему необходимо:',
		'options': ['adduser testuser', 'useradd testuser', 'user add testuser', 'add user testuser'],
		'correct_answers': ['adduser testuser', 'useradd testuser']
	},
	{
		'question': 'Добавить пользователя testuser в группу garda, не удаляя его из всех остальных групп возможно:',
		'options': ['usermod testuser -aG garda', 'usermod garda -aG testuser', 'usermod testuser -G garda', 'usermod garda -G testuser'],
		'correct_answers': ['usermod testuser -aG garda']
	},
	{
		'question': 'Как вывести список всех групп, куда включен пользователь testuser?',
		'options': ['testuser groups', 'groups', 'groups testuser', 'list groups testuser'],
		'correct_answers': ['groups testuser']
	},
	{
		'question': 'Как вывести всех членов группы root?',
		'options': ['users root', 'users', 'root users', 'cat /etc/group | grep root:'],
		'correct_answers': ['cat /etc/group | grep root:']
	},
	{
		'question': 'Как прервать текущую операцию, выполняемую в терминале?',
		'options': ['ctrl+z', 'ctrl+x', 'ctrl+c', 'ctrl+Esc'],
		'correct_answers': ['ctrl+c']
	},
	{
		'question': 'Как перевести в фоновый режим текущую операцию, выполняемую в терминале?',
		'options': ['ctrl+z', 'ctrl+x', 'ctrl+c', 'ctrl+Esc'],
		'correct_answers': ['ctrl+z']
	},
	{
		'question': 'Как перевести на передний план фоновый процесс в терминале?',
		'options': ['foreground', 'fg', 'FG', 'FOREGROUND'],
		'correct_answers': ['fg']
	},
	{
		'question': 'Какая команда используется для вывода процессов, наиболее утилизирующих ресурсы системы в Linux?',
		'options': ['ps -aux', 'tasklist -a', 'process -a', 'top'],
		'correct_answers': ['top']
	},
	{
		'question': 'Как посмотреть запущенные процессы в текущей терминальной сессии в Linux:',
		'options': ['ps', 'tasklist', 'process', 'top'],
		'correct_answers': ['ps']
	},
	{
		'question': 'Какая команда используется для остановки выполнения процесса в Linux?',
		'options': ['kill', 'stop', 'end', 'terminate'],
		'correct_answers': ['kill']
	},
	{
		'question': 'Как добавить сервис в автозагрузку?',
		'options': ['systemctl on <имя_сервиса>', 'service enable <имя_сервиса>', 'service <имя_сервиса> enable', 'systemctl enable <имя_сервиса>'],
		'correct_answers': ['systemctl enable <имя_сервиса>']
	},
	{
		'question': 'Необходимо перезапустить сервис агента ГардаБД dbs_agent. Права root имеются. Выберите один или несколько вариантов:',
		'options': ['systemctl stop dbs_agent && systemctl start dbs_agent', 'systemctl dbs_agent stop && systemctl dbs_agent start', 'service dbs_agent restart', 'service restart dbs_agent', 'systemctl restart dbs_agent.service', 'systemctl dbs_agent.service restart', 'systemctl restart dbs_agent', 'systemctl dbs_agent restart'],
		'correct_answers': ['systemctl stop dbs_agent && systemctl start dbs_agent', 'service dbs_agent restart', 'systemctl restart dbs_agent.service', 'systemctl restart dbs_agent']
	},
	{
		'question': 'В рабочей директории находится скрипт с именем «script.sh». Права на запуск имеются. Вывод команды pwd: /home/gardauser. Выберите один или несколько ошибочных вариантов запуска скрипта на выполнение:',
		'options': ['script.sh', '/home/gardauser/script.sh', './script.sh', '/home/gardauser/.script.sh', '../../home/gardauser/script.sh'],
		'correct_answers': ['script.sh', '/home/gardauser/.script.sh', '../../home/gardauser/script.sh']
	},
	{
		'question': 'Выберите минимально необходимые условия для возможности запуска исполняемого файла (скрипта):',
		'options': ['У пользователя должны быть необходимые права на чтение исполняемого файла', 'У группы пользователя должны быть права на чтение исполняемого файла', 'У пользователя должны быть права на запуск исполняемого файла', 'У группы пользователя должны быть права на запуск исполняемого файла', 'Файл должен быть исполняемым', 'Расширение файла должно указывать на исполняемый файл: .sh, .shell, .py и т.д.'],
		'correct_answers': ['У пользователя должны быть права на запуск исполняемого файла', 'Файл должен быть исполняемым', 'Расширение файла должно указывать на исполняемый файл: .sh, .shell, .py и т.д.']
	},
	{
		'question': 'Необходимо закомментировать строку в bash-скрипте, выберите один или несколько вариантов:',
		'options': ['# comment', '!-- comment', '/* comment */', '// comment'],
		'correct_answers': ['# comment']
	},
	{
		'question': 'Необходимо написать скрипт на bash. Выберите правильную последовательность действий:',
		'options': ['Создать файл с расширением .sh, в самой верхней строке задать директиву #!/bin/bash, сохранить, сделать файл исполняемым с помощью chmod', 'Создать файл, в самой верхней строке задать директиву #!/bin/bash, сохранить, сделать файл исполняемым с помощью chmod', 'Создать файл с расширением .sh, в самой верхней строке задать директиву !/bin/bash, сохранить, сделать файл исполняемым с помощью chmod', 'Создать файл, в самой верхней строке задать директиву !/bin/bash, сохранить, сделать файл исполняемым с помощью chmod'],
		'correct_answers': ['Создать файл с расширением .sh, в самой верхней строке задать директиву #!/bin/bash, сохранить, сделать файл исполняемым с помощью chmod']
	},
	{
		'question': 'Необходимо узнать все ip-адреса сетевых интерфейсов сервера. Выберите возможные варианты:',
		'options': ['ipconfig /all', 'ip a', 'iwconfig -a', 'ifconfig -a'],
		'correct_answers': ['ip a', 'ifconfig -a']
	},
	{
        'question': 'Необходимо вывести таблицу маршрутизации. Выберите возможные варианты:',
        'options': ['netstat -an', 'route print', 'routel', 'netstat -rn', 'route –rn', 'ip route'],
        'correct_answers': ['netstat -rn', 'route –rn', 'ip route']
	},
	{
		'question': 'Необходимо задать ip-адрес 10.20.30.40/29 для интерфейса bond0. Выберите возможные варианты:',
		'options': ['ipconfig bond0 ip 10.20.30.40 netmask 255.255.255.248', 'ip address add 10.20.30.40/255.255.255.248 dev bond0', 'iconfig bond0 10.20.30.40 netmask 255.255.255.248', 'отредактировать файл /etc/network/interfaces и перезагрузить службу network', 'отредактировать файл /etc/netconfig и перезагрузить службу network'],
		'correct_answers': ['ip address add 10.20.30.40/29 dev bond0', 'отредактировать файл /etc/network/interfaces и перезагрузить службу network']
	},
	{
		'question': 'В чем отличие в реализации эхо-запросов (ping) в Linux от Windows:',
		'options': ['Размер пакета, отправляемый по умолчанию', 'В Linux – round trip time; в Windows – One way', 'Количество повторений по умолчанию', 'В Windows задержка указывается с точностью до секунды, в Linux – тысячных секунды.'],
		'correct_answers': ['Количество повторений по умолчанию', 'Размер пакета, отправляемый по умолчанию', 'В Windows задержка указывается с точностью до секунды, в Linux – тысячных секунды.']
	},
	{
		'question': 'На сервере есть 3 активных сетевых интерфейса ¬– eth0, bond0, eth1. Необходимо проверить по какому маршруту идет трафик с интерфейса eth1 до узла 1.2.3.4:',
		'options': ['tracert -S eth1 1.2.3.4', 'tracert -S <IP-адрес_eth1> 1.2.3.4', 'traceroute 1.2.3.4', 'traceroute -i eth1 1.2.3.4'],
		'correct_answers': ['traceroute -i eth1 1.2.3.4']
	},
	{
		'question': 'Какие из команд принимают в качестве параметров регулярные выражения?',
		'options': ['grep', 'find', 'search', 'match', 'sed'],
		'correct_answers': ['grep', 'find', 'sed']
	},
	{
		'question': 'Какой символ используется для обозначения начала строки в регулярном выражении?',
		'options': ['^', '$', '*', '+'],
		'correct_answers': ['^']
	},
	{
		'question': 'Какой символ используется для обозначения конца строки в регулярном выражении?',
		'options': ['^', '$', '*', '+'],
		'correct_answers': ['$']
	},
	{
		'question': 'Какой символ используется для обозначения любого символа в регулярном выражении?',
		'options': ['.', '*', '?', '['],
		'correct_answers': ['.']
	},
	{
		'question': 'Какой символ используется для обозначения ноль или более повторений предыдущего символа в регулярном выражении?',
		'options': ['.', '*', '?', '['],
		'correct_answers': ['*']
	},
	{
		'question': 'Какой символ используется для обозначения одного или более повторений предыдущего символа в регулярном выражении?',
		'options': ['.', '*', '?', '+'],
		'correct_answers': ['+']
	},
	{
		'question': 'Какой символ используется для обозначения ноль или одного повторения предыдущего символа в регулярном выражении?',
		'options': ['.', '*', '?', '['],
		'correct_answers': ['?']
	},
	{
		'question': 'Какой символ используется для обозначения альтернативы в регулярном выражении?',
		'options': ['|', '&', '!', '%'],
		'correct_answers': ['|']
	},
	{
		'question': 'Какой символ используется для экранирования специальных символов в регулярном выражении?',
		'options': ['\\', '^', '/', '*'],
		'correct_answers': ['\\']
	},
	{
		'question': 'Какая команда используется для замены совпадений с регулярным выражением в текстовом файле в Linux?',
		'options': ['sed', 'replace', 'change', 'modify'],
		'correct_answers': ['sed']
	},
	{
		'question': 'Необходимо найти имена файлов c расширением .conf, содержащие подстроки “meteor” или “sniffer” в конце строки. Дополнительно необходимо вывести номера строк, в которых содержатся искомые подстроки. Каталог, в котором необходимо произвести поиск ¬ /opt:',
		'options': ['find /opt -type f -name "*.conf" -exec grep -n -H -- -e meteor -e sniffer {} \\;', "find /opt -type f -name \"*.conf\" -exec grep -n -H -- 'meteor$\\|sniffer$' {} \\;", 'find /opt -type f -name "*.conf" -exec grep --number -H -- \'meteor$\\|sniffer$\' {} \\;', 'find /opt -type f -name "*.conf" | grep -n -H -- \'meteor$\\|sniffer$\' {} \\;', "find /opt -type f -name \"*.conf\" -exec grep -n -H -- -e meteor -e sniffer {} \\;"],
		'correct_answers': ['find /opt -type f -name "*.conf" -exec grep -n -H -- -e meteor -e sniffer {} \\;']
	}
]

questions_network = [
  {
    "question": "Локальные компьютерные сети это?",
    "options": ["Сеть, к которой подключены все компьютеры одного населенного пункта", "Сеть, к которой подключены все компьютеры одной страны", "Сеть, к которой подключены все компьютеры в одном помещении или здании", "Сеть, к которой подключены все компьютеры области"],
    "correct_answers": ["Сеть, к которой подключены все компьютеры в одном помещении или здании"]
  },
  {
    "question": "Протокол - это?",
    "options": ["Правило преобразования информации", "Линия связи, соединяющая компьютеры в сети", "Специальная программа, позволяющая найти ресурс в сети", "Набор специальных правил для работы в сети"],
    "correct_answers": ["Набор специальных правил для работы в сети"]
  },
  {
    "question": "Схема соединения компьютеров в сети называется?",
    "options": ["Архитектура", "Топология", "Расположением", "Алгоритм"],
    "correct_answers": ["Топология"]
  },
  {
    "question": "Какая технология использует в качестве проводника витую пару?",
    "options": ["PON", "Fiber chanel", "Fast Ethernet", "WAN"],
    "correct_answers": ["Fast Ethernet"]
  },
  {
    "question": "В чем отличие концентратора от коммутатора?",
    "options": ["Функцией адресности", "Количеством портов", "Возможность взаимодействовать с телефонными сетями", "Шифрованием трафика"],
    "correct_answers": ["Функцией адресности"]
  },
  {
    "question": "Основной (неделимой) единицей сетевого информационного обмена является?",
    "options": ["Бит;", "Пакет;", "Кадр;", "Дейтаграмма;"],
    "correct_answers": ["Кадр;"]
  },
  {
    "question": "Что описывает модель OSI?",
    "options": ["Правила и процедуры передачи данных в различных сетевых средах при организации сеанса связи", "Только процедуры передачи данных в различных сетевых средах при организации сеанса связи", "Только правила передачи данных в различных сетевых средах при организации сеанса связи", "Устройство LAN сетей"],
    "correct_answers": ["Правила и процедуры передачи данных в различных сетевых средах при организации сеанса связи"]
  },
  {
    "question": "На сколько уровней модель OSI разделяет коммуникационные функции?",
    "options": ["3", "5", "7", "8"],
    "correct_answers": ["7"]
  },
  {
    "question": "Какие задачи выполняют уровни OSI в процессе передачи данных по сети?",
    "options": ["Первые три уровня выполняют одинаковую задачу, последующие уровни выполняют каждый свою задачу", "Уровни выполняют одинаковую задачу, отличия лишь в оборудовании", "Каждый уровень выполняет свою определенную задачу", "Все уровни выполняют одну задачу, кроме последнего, где пользователь совершает действия"],
    "correct_answers": ["Каждый уровень выполняет свою определенную задачу"]
  },
  {
    "question": "Выберите правильное расположение уровней модели OSI от 7 до 1?",
    "options": ["Прикладной, канальный, представительский, сеансовый, транспортный, сетевой, физический", "Физический, представительский, прикладной, канальный, сеансовый, транспортный, сетевой", "Прикладной, представительский, сеансовый, сетевой, транспортный, канальный, физический", "Прикладной, представительский, сеансовый, транспортный, сетевой, канальный, физический"],
    "correct_answers": ["Прикладной, представительский, сеансовый, транспортный, сетевой, канальный, физический"]
  },
  {
    "question": "Доставку каждого отдельного пакета до места назначения выполняет протокол?",
    "options": ["SMTP", "NAT", "HTTP", "TCP"],
    "correct_answers": ["TCP"]
  },
  {
    "question": "Какой уровень обеспечивает передачу кадров информации?",
    "options": ["Сетевой", "Канальный", "Физический", "Кадровый"],
    "correct_answers": ["Канальный"]
  },
  {
    "question": "К какому уровню модели OSI относится IP – адрес?",
    "options": ["Физический;", "Сеансовый;", "Канальный;", "Сетевой;"],
    "correct_answers": ["Сетевой;"]
  },
  {
    "question": "Что такое резолвер?",
    "options": ["Это хосты-хранилища запросов к DNS", "Это серверы, которые провайдеры используют для поиска в их базе данных конкретного узла, запрашиваемого пользователем", "Это серверы имен корня, они хранят информацию о местоположении серверов домена верхнего уровня", "Это правило фильтрации запросов к подсети"],
    "correct_answers": ["Это серверы, которые провайдеры используют для поиска в их базе данных конкретного узла, запрашиваемого пользователем"]
  },
  {
    "question": "Какой из примеров является Spoofing атакой?",
    "options": ["Пользователям присылают квитанции с адресов, схожих с банковскими", "Пользователя взламывают путем подбора данных аутентификации", "Злоумышленник пропускает трафик через себя, притворяясь участником разговора.", "Это попытка злоумышленников загрузить сервер таким образом, чтобы он перестал работать."],
    "correct_answers": ["Пользователям присылают квитанции с адресов, схожих с банковскими"]
  },
  {
    "question": "Какой из примеров является DDoS атакой?",
    "options": ["Злоумышленник атакует с внедрением вредоносного кода SQL в веб‑приложение, с целью получить доступ к базе данных и уничтожить БД.", "Злоумышленник подкладывает в переписку вредоносные файлы, с целью получить доступ к личной информации пользователя.", "Злоумышленник атакует со своего хоста, пытаясь вызвать отказ системы в обслуживании, при котором легальные пользователи системы не могут получить доступ к системным ресурсам.", "Злоумышленник атакует с нескольких источников, пытаясь загрузить сервер таким образом, чтобы он перестал работать."],
    "correct_answers": ["Злоумышленник атакует с нескольких источников, пытаясь загрузить сервер таким образом, чтобы он перестал работать."]
  },
  {
    "question": "Какой из примеров является MITM атакой?",
    "options": ["Злоумышленник подкладывает в переписку вредоносные файлы, с целью получить доступ к личной информации пользователя.", "Пользователя взламывают путем подбора данных аутентификации", "Злоумышленник пропускает трафик через себя, притворяясь участником разговора.", "Это попытка злоумышленников загрузить сервер таким образом, чтобы он перестал работать."],
    "correct_answers": ["Злоумышленник пропускает трафик через себя, притворяясь участником разговора."]
  },
  {
    "question": "Что такое брендмауэр?",
    "options": ["Это хранилище запросов от хоста к маршрутизатору", "Это межсетевой экран", "Это фильтр между компьютером и сетью, который проверяет безопасность входящих и исходящих данных", "Это служба коммутатора, которая пишет в таблицу маршрутизации"],
    "correct_answers": ["Это межсетевой экран", "Это фильтр между компьютером и сетью, который проверяет безопасность входящих и исходящих данных"]
  },
  {
    "question": "Для чего используют WPS?",
    "options": ["Web Protect Standart (WPS) – стандарт IEEE 806.3, описывающий проектирование сетей с учетом защиты от кибератак", "Web Policy Set (WPS) – cтандарт установки соединения, с подтверждением, исправлением ошибок и управлением потоком", "Wi-Fi Protected Setup (WPS) — стандарт (и одноимённый протокол) полуавтоматического создания беспроводной сети Wi-Fi", "World Priority Standart (WPS) – стандарт ISO №100Base-WPS обработки запросов с учетом приоритетов"],
    "correct_answers": ["Wi-Fi Protected Setup (WPS) — стандарт (и одноимённый протокол) полуавтоматического создания беспроводной сети Wi-Fi"]
  },
  {
    "question": "Чем примечателен стандарт WPS с точки зрения безопасности?",
    "options": ["Web Protect Standart (WPS) – стандарт который с момента внедрения обеспечивает безопасность в проектировании сетей и является актуальным.", "Wi-Fi Protected Setup (WPS) — стандарт является уязвимым для взлома путем подбора 8 – значного пин-кода", "World Priority Standart (WPS) – стандарт обработки запросов с учетом приоритетов отменен в ноябре 1998г так как приоритеты для пользователей сети противоречат идее свободного интернета.", "Web Policy Set (WPS) – cтандарт установки соединения с подтверждением, исправлением ошибок и управлением потоком версии 3.002 применяется во всех роутерах с 2009г."],
    "correct_answers": ["Wi-Fi Protected Setup (WPS) — стандарт является уязвимым для взлома путем подбора 8 – значного пин-кода"]
  },
  {
    "question": "Что можно сделать через Wireshark?",
    "options": ["Может быть использована для отладки и тестирования сетевых приложений", "Может быть использована для создания правил брэндмауэра", "Может быть использована для мониторинга и аудита сетевой безопасности", "Может быть использована для обнаружения и решение сетевых проблем", "Может быть использована для изучения работы сетевых протоколов"],
    "correct_answers": ["Может быть использована для отладки и тестирования сетевых приложений", "Может быть использована для мониторинга и аудита сетевой безопасности", "Может быть использована для обнаружения и решение сетевых проблем", "Может быть использована для изучения работы сетевых протоколов"]
  },
  {
    "question": "Для чего нужен сниффер?",
    "options": ["Это простой инструмент только для снятия копии проходящего трафика", "Это инструмент, позволяющий перехватывать, анализировать и модернизировать все запросы, которые через него проходят", "Это инструмент для оптимизации маршрутизации пакетов", "Это простой инструмент по проверке на отсутствие дублирующих IP в подсети"],
    "correct_answers": ["Это инструмент, позволяющий перехватывать, анализировать и модернизировать все запросы, которые через него проходят"]
  },
  {
    "question": "Что такое ARP?",
    "options": ["Это протокол отслеживания TTL пакета, и повторной отправки", "Это инструмент, который убирает записи из таблицы маршрутизации после прошествия определенного времени", "Это инструмент для обнаружения новых хостов в LAN", "Это протокол для определения соответствия между логическим адресом сетевого уровня (IP) и физическим адресом устройства (MAC)"],
    "correct_answers": ["Это протокол для определения соответствия между логическим адресом сетевого уровня (IP) и физическим адресом устройства (MAC)"]
  },
  {
    "question": "К какому уровню модели OSI относится MAC адрес и что это?",
    "options": ["Относится ко 2 уровню модели OSI, это уникальный номер устройства, присвоенный при изготовлении из 12 символов", "Относится к 3 уровню модели OSI, это уникальный номер устройства из 16 символов", "Относится ко 2 уровню модели OSI, это уникальный номер устройства который присваивает маршрутизатор из 12 символов", "Относится к 3 уровню модели OSI, это уникальный номер устройства из 16 цифр и букв"],
    "correct_answers": ["Относится ко 2 уровню модели OSI, это уникальный номер устройства, присвоенный при изготовлении из 12 символов"]
  },
  {
    "question": "Выберите верное определение хэшированию:",
    "options": ["Это процесс сохранения данных локально, который позволяет быстрее получить к ним доступ при будущих запросах", "Это способ превратить данные в строку фиксированной длины, пропуская через функцию, которая получает на их основе уникальную последовательность символов.", "Это математический алгоритм, преобразовывающий произвольный массив данных в состоящую из букв и цифр строку фиксированной длины", "Это способ сжатия сообщения, в  котором используются два математически зависимых, но не идентичных алгоритма"],
    "correct_answers": ["Это способ превратить данные в строку фиксированной длины, пропуская через функцию, которая получает на их основе уникальную последовательность символов.", "Это математический алгоритм, преобразовывающий произвольный массив данных в состоящую из букв и цифр строку фиксированной длины"]
  },
   {
    "question": "Выберите порядок SSL протокола:",
    "options": ["Рукопожатие => Передача SSL сертификата => Проверка подлинности сертификата => Шифрование сообщения", "Рукопожатие => Проверка подлинности сертификата сайта => Договор о способе шифрования => Шифрование сообщения", "Рукопожатие => Передача SSL сертификата => Выбор способа шифрования => Шифрование сообщения", "Рукопожатие => Обращение в DNS о подлинности сайта => Передача SSL сертификата => Установка зашифрованного канала передачи"],
    "correct_answers": ["Рукопожатие => Передача SSL сертификата => Выбор способа шифрования => Шифрование сообщения"]
  },
  {
    "question": "На какие два класса можно разделить алгоритмы шифрования?",
    "options": ["Сквозные", "С открытым ключом", "Симметричные", "Ассиметричные"],
    "correct_answers": ["Симметричные", "Ассиметричные"]
  },
  {
    "question": "Процесс какого протокола называют DORA?",
    "options": ["ICMP", "DNS", "DHCP", "FTP"],
    "correct_answers": ["DHCP"]
  },
  {
    "question": "Клиенту выдан временный IP адрес. По прошествии какого времени клиент инициализирует процедуру получения нового IP или обновления адреса?",
    "options": ["При наступлении 60% срока аренды", "По прошествии 3/4  срока аренды", "По прошествии 70% срока аренды", "При наступлении 50% срока аренды"],
    "correct_answers": ["По прошествии 50% срока аренды"]
  },
  {
    "question": "Что такое NAT технология?",
    "options": ["Эта технология обеспечивает подключение к Интернету закрытых IP-сетей, использующих незарегистрированные IP-адреса путем подмены на правомочные адреса до переадресации пакетов в другую сеть", "Принцип работы протокола подразумевает наличие в сегменте некоторого множества маршрутизаторов, один из которых исполняет роль владельца общего виртуального IP-адреса", "Это протокол резервирования связи, который используется для обеспечения надежности и доступности сети в случае отказа канала", "Это технология, используемая для организации доступа хоста по коммутируемым линиям в удаленной сети, с помощью подмены IPv6"],
    "correct_answers": ["Эта технология обеспечивает подключение к Интернету закрытых IP-сетей, использующих незарегистрированные IP-адреса путем подмены на правомочные адреса до переадресации пакетов в другую сеть"]
  }
]

# Конфигурация тестирования
NUM_QUESTIONS = 1
PASSING_PERCENTAGE = 80
RESULTS_FILE = 'C://Хлам//учеба DE//Работа и задачи//ДС//Тесты ДС//Скрипт для тестирования//test_results.csv'  # Имя файла для сохранения результатов

# Маршруты Flask
@ck_test.route('/', methods=['GET', 'POST'])
def index():
    if request.method == 'POST':
        fio = request.form['fio']
        selected_questions = random.sample(questions_linux, NUM_QUESTIONS)
        return render_template('test.html', fio=fio, questions=selected_questions, enumerate=enumerate)  # Передаем enumerate
    return render_template('index.html')  # Форма для ввода ФИО

@ck_test.route('/result', methods=['POST'])
def result():
    fio = request.form['fio']
    correct_answers_count = 0
    incorrect_answers = [] # Список для хранения информации о неправильных ответах

    # Получаем ответы пользователя и проверяем их
    for question_index in range(NUM_QUESTIONS):
        question_id = f"question_{question_index}"
        user_answers = request.form.getlist(question_id) # Получаем все выбранные варианты ответов
        question_text = request.form.get(f"question_text_{question_index}") # Получаем текст вопроса из формы!

        #if selected_question: #больше не нужно
        is_correct = False
        #находим правильный ответ в списке вопросов.
        for q in questions_linux:
            if q["question"] == question_text:
                selected_question = q
                # Сравниваем ответы пользователя с правильными ответами
                is_correct = set(user_answers) == set(selected_question['correct_answers'])
                break

        if is_correct:
            correct_answers_count += 1
        else:
            incorrect_answers.append({
                'question': question_text, # Текст вопроса берем из запроса
                'user_answers': user_answers,
                'correct_answers': selected_question['correct_answers'],
                'question_number': question_index + 1 # нумерация с 1
            })

    percentage_correct = (correct_answers_count / NUM_QUESTIONS) * 100

    if percentage_correct >= PASSING_PERCENTAGE:
        result_message = f"Тест пройден успешно! У вас {percentage_correct:.2f}% верных ответов."
        result_status = "Успешно"
    else:
        result_message = f"Тест не пройден. У вас {percentage_correct:.2f}% верных ответов."
        result_status = "Неуспешно"

    # Сохраняем результаты в CSV
    try:
        with open(RESULTS_FILE, mode='a', newline='', encoding='utf-8') as file:
            writer = csv.writer(file)
            # проверка заголовка, и что файл пуст. Это предотвращает повторную запись заголовка при каждом запуске теста.
            if file.tell() == 0: #Если файл пуст, записываем заголовок. 
                writer.writerow(['ФИО', 'Правильных ответов', 'Статус', 'Номер Вопроса','Текст вопроса', 'Ответы пользователя', 'Правильные ответы'])

            # Записываем основную информацию о результате
            writer.writerow([fio, correct_answers_count, result_status, "", "", "", ""]) #пустые строки для инфы об ошибках

            # Записываем информацию о каждой ошибке
            for error in incorrect_answers:
                writer.writerow(["", "", "", error['question_number'], error['question'], ", ".join(error['user_answers']), ", ".join(error['correct_answers'])])

        print(f"Результаты успешно записаны в файл: {RESULTS_FILE}")  # Добавлено
    except Exception as e:
        print(f"Ошибка при записи в файл: {e}")
        result_message += "\nНе удалось сохранить результаты в файл." # сообщаем об ошибке

    return render_template('result.html', fio=fio, result_message=result_message, incorrect_answers=incorrect_answers)

# Запуск приложения
if __name__ == '__main__':
    ck_test.run(debug=True) 
 # режим debug Автоматически перезагружает приложение при изменении кода. 
 # Предоставляет отладчик, который позволяет пошагово выполнять код и анализировать значения переменных.
